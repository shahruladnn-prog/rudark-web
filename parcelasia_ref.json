{
  "openapi": "3.0.0",
  "info": {
    "title": "MyParcel Asia API",
    "version": "2.1",
    "description": "Documentation for the public API of MyParcel Asia. This API enables your system to use the MyParcel Asia engine to generate consignment notes. \n\n**General Guidelines:**\n- ONLY POST requests are supported.\n- `api_key` must always be sent in the POST parameters.\n- All responses are in JSON format.\n\n**Hash Calculation:**\nFor validation, a hash is generated by concatenating `status`, `message`, and `data` (JSON encoded) with your `api_secret`, then hashing the result with MD5.",
    "contact": {
      "name": "MyParcel Asia Support",
      "url": "https://myparcelasia.com/"
    }
  },
  "servers": [
    {
      "url": "https://app.myparcelasia.com/apiv2",
      "description": "Production Endpoint"
    },
    {
      "url": "https://demo.myparcelasia.com/apiv2",
      "description": "Development / Demo Endpoint"
    }
  ],
  "paths": {
    "/user": {
      "post": {
        "summary": "Get User Details",
        "description": "Get user details belonging to the api_key. Useful for testing connection.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User details retrieved",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/BaseResponse" }
              }
            }
          }
        }
      }
    },
    "/get_postcode_details": {
      "post": {
        "summary": "Get Postcode Details",
        "description": "Verify postcode and auto-populate city/state details.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "postcode": { "type": "string" }
                },
                "required": ["api_key", "postcode"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Postcode details",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/BaseResponse" }
              }
            }
          }
        }
      }
    },
    "/check_price": {
      "post": {
        "summary": "Check Price (Single)",
        "description": "Get list of prices available for a specific shipment intent.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "sender_postcode": { "type": "string" },
                  "receiver_postcode": { "type": "string", "description": "Required for Domestic" },
                  "receiver_country_code": { "type": "string", "description": "Optional ISO code (e.g., MY, SG). Default: MY" },
                  "declared_weight": { "type": "number", "description": "Weight in KG" }
                },
                "required": ["api_key", "sender_postcode", "declared_weight"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Price list returned",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/sdd_price": {
      "post": {
        "summary": "Check Price (Same Day Delivery)",
        "description": "Get prices for SDD couriers like Grab Express, Lalamove.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "pickup_address": { "type": "string" },
                  "pickup_postcode": { "type": "string" },
                  "pickup_lat": { "type": "string" },
                  "pickup_lng": { "type": "string" },
                  "receiver_address": { "type": "string" },
                  "receiver_postcode": { "type": "string" },
                  "receiver_lat": { "type": "string" },
                  "receiver_lng": { "type": "string" },
                  "declared_weight": { "type": "number" }
                },
                "required": ["api_key", "pickup_address", "pickup_postcode", "pickup_lat", "pickup_lng", "receiver_address", "receiver_postcode", "receiver_lat", "receiver_lng", "declared_weight"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SDD Prices returned",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_parcel_sizes": {
      "post": {
        "summary": "Get Parcel Sizes",
        "description": "Get all parcel sizes available to be chosen.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "List of sizes",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_content_types": {
      "post": {
        "summary": "Get Content Types",
        "description": "Get product type IDs for use in create_shipment.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "List of content types",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/create_shipment": {
      "post": {
        "summary": "Create Shipment (Add to Cart)",
        "description": "Create a shipment record. This adds the item to the cart.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "integration_order_id": { "type": "string", "description": "Reference ID for the shipment" },
                  "integration_order_data": { 
                    "type": "object",
                    "properties": {
                        "connote_show_invoice": { "type": "string", "enum": ["yes", "no"] },
                        "total_weight": { "type": "number" },
                        "line_item": { "type": "array", "items": { "type": "object" } }
                    }
                  },
                  "send_method": { "type": "string", "enum": ["pickup", "walkin", "dropoff"] },
                  "send_date": { "type": "string", "format": "date" },
                  "type": { "type": "string", "enum": ["parcel", "document"] },
                  "declared_weight": { "type": "string" },
                  "provider_code": { "type": "string" },
                  "size": { "type": "string" },
                  "length": { "type": "number" },
                  "width": { "type": "number" },
                  "height": { "type": "number" },
                  "content_type": { "type": "string" },
                  "content_description": { "type": "string" },
                  "content_value": { "type": "number" },
                  "has_cod": { "type": "string", "enum": ["yes", "no"] },
                  "has_sms": { "type": "string", "enum": ["yes", "no"] },
                  "sender_name": { "type": "string" },
                  "sender_phone": { "type": "string" },
                  "sender_email": { "type": "string" },
                  "sender_company_name": { "type": "string" },
                  "sender_address_line_1": { "type": "string" },
                  "sender_address_line_2": { "type": "string" },
                  "sender_address_line_3": { "type": "string" },
                  "sender_address_line_4": { "type": "string" },
                  "sender_postcode": { "type": "string" },
                  "sender_city": { "type": "string" },
                  "sender_state": { "type": "string" },
                  "sender_country_code": { "type": "string" },
                  "receiver_name": { "type": "string" },
                  "receiver_phone": { "type": "string" },
                  "receiver_email": { "type": "string" },
                  "receiver_company_name": { "type": "string" },
                  "receiver_address_line_1": { "type": "string" },
                  "receiver_address_line_2": { "type": "string" },
                  "receiver_address_line_3": { "type": "string" },
                  "receiver_address_line_4": { "type": "string" },
                  "receiver_postcode": { "type": "string" },
                  "receiver_city": { "type": "string" },
                  "receiver_state": { "type": "string" },
                  "receiver_country_code": { "type": "string" }
                },
                "required": ["api_key", "send_method", "send_date", "type", "declared_weight", "provider_code", "size", "content_type", "content_description", "content_value", "sender_name", "sender_phone", "sender_address_line_1", "sender_postcode", "receiver_name", "receiver_phone", "receiver_email", "receiver_address_line_1"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Shipment created",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_cart_items": {
      "post": {
        "summary": "Get Cart Items",
        "description": "Get all shipments ready for checkout.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cart items retrieved",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/checkout": {
      "post": {
        "summary": "Checkout Shipments",
        "description": "Checkout shipments to confirm balance reduction and generate connote links.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "shipment_keys": { "type": "array", "items": { "type": "string" } }
                },
                "required": ["api_key", "shipment_keys"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Checkout successful",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_shipment_statuses": {
      "post": {
        "summary": "Get Shipment Statuses",
        "description": "Get map of status codes to human readable labels.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Statuses retrieved",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_shipments": {
      "post": {
        "summary": "Get Shipments Details",
        "description": "Get shipment details by array of shipment keys.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "shipment_keys": { "type": "array", "items": { "type": "string" } }
                },
                "required": ["api_key", "shipment_keys"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Shipment details retrieved",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_shipment_history": {
      "post": {
        "summary": "Get Shipment History",
        "description": "Get all paid shipments with pagination.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "page": { "type": "integer", "default": 1 }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "History retrieved",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/get_consignment_note": {
      "post": {
        "summary": "Get Consignment Note (PDF)",
        "description": "Download PDF consignment note. Provide either shipment_keys OR tracking_no.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "shipment_keys": { "type": "array", "items": { "type": "string" } },
                  "tracking_no": { "type": "array", "items": { "type": "string" } }
                },
                "required": ["api_key"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "PDF File or Link",
            "content": { "application/pdf": { "schema": { "type": "string", "format": "binary" } } }
          }
        }
      }
    },
    "/check_price_bulk": {
      "post": {
        "summary": "Check Price Bulk",
        "description": "Get prices for multiple shipments at once.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "shipments": { 
                    "type": "array", 
                    "items": {
                      "type": "object",
                      "properties": {
                        "sender_postcode": { "type": "string" },
                        "receiver_postcode": { "type": "string" },
                        "receiver_country_code": { "type": "string" },
                        "declared_weight": { "type": "string" },
                        "provider_code": { "type": "string" },
                        "type": { "type": "string" }
                      }
                    } 
                  }
                },
                "required": ["api_key", "shipments"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Bulk prices retrieved",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/create_bulk_awb": {
      "post": {
        "summary": "Create Bulk AWB",
        "description": "Directly create shipments and generate AWB URLs without cart flow.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "shipments": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "integration_order_id": { "type": "string" },
                        "integration_order_data": { "type": "object" },
                        "send_method": { "type": "string" },
                        "send_date": { "type": "string" },
                        "type": { "type": "string" },
                        "declared_weight": { "type": "number" },
                        "provider_code": { "type": "string" },
                        "size": { "type": "string" },
                        "length": { "type": "number" },
                        "width": { "type": "number" },
                        "height": { "type": "number" },
                        "content_type": { "type": "string" },
                        "content_description": { "type": "string" },
                        "content_value": { "type": "number" },
                        "sender_name": { "type": "string" },
                        "sender_phone": { "type": "string" },
                        "sender_email": { "type": "string" },
                        "sender_address_line_1": { "type": "string" },
                        "sender_postcode": { "type": "string" },
                        "receiver_name": { "type": "string" },
                        "receiver_phone": { "type": "string" },
                        "receiver_email": { "type": "string" },
                        "receiver_address_line_1": { "type": "string" },
                        "receiver_postcode": { "type": "string" },
                        "receiver_country_code": { "type": "string" },
                        "pickup_address": { "type": "string", "description": "SDD only" },
                        "pickup_lat": { "type": "string", "description": "SDD only" },
                        "pickup_lng": { "type": "string", "description": "SDD only" },
                        "receiver_lat": { "type": "string", "description": "SDD only" },
                        "receiver_lng": { "type": "string", "description": "SDD only" }
                      }
                    }
                  }
                },
                "required": ["api_key", "shipments"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Bulk AWB response",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    },
    "/trace": {
      "post": {
        "summary": "Trace Shipment",
        "description": "Get latest status of a tracking number.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "api_key": { "type": "string" },
                  "tracking_no": { "type": "string" }
                },
                "required": ["api_key", "tracking_no"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Shipment status",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/BaseResponse" } } }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "BaseResponse": {
        "type": "object",
        "properties": {
          "status": { "type": "boolean" },
          "message": { "type": "string" },
          "data": { "type": "object" },
          "meta": { "type": "object" },
          "hash": { "type": "string" }
        }
      }
    }
  }
}